angular.module("UnitsConversion",[]),angular.module("UnitsConversion").service("Polynome",function(){"use strict";var a=function(a){var b=this;this.polynomeObj={};var c=[0];Object.keys(a).forEach(function(d){var e=d.match(/[a-zA-Z_\.\-]*(\d+)/);if(e){var f=parseInt(e[1],10);c.push(f),b.polynomeObj[f]=parseFloat(a[d])}}),this.size=Math.max.apply(null,c)+1};a.prototype.solveEq=function(a){switch(this.size){case 1:return[];case 2:return b(this.polynomeObj,a);case 3:return c(this.polynomeObj,a);case 4:return d(this.polynomeObj,a);default:return[]}},a.prototype.invert=function(a){var b=this.solveEq(a);return b.length?b[0]:null},a.prototype.direct=function(a){var b=this,c=0;return Object.keys(this.polynomeObj).forEach(function(d){c+=b.polynomeObj[d]*Math.pow(a,d)}),c};var b=function(a,b){return a[1]?[(b-(a[0]?a[0]:0))/a[1]]:[]},c=function(a,b){var c=Math.pow(a[1],2)-4*(a[0]-b)*a[2];return 0>c?[]:0===c?[-a[1]/(2*a[2])]:c>0?[(-a[1]+Math.sqrt(c))/(2*a[2]),(-a[1]-Math.sqrt(c))/(2*a[2])]:void 0},d=function(a,b){if(0===a[3])return c(equ,b);if(0===a[1]&&0===a[2])return sol[0]=1,[-Math.pow((a[0]-b)/a[3],1/3)];var d=(a[0]-b)/a[3],e=a[1]/a[3],f=a[2]/a[3],g=f/3,h=e-g*f,i=d-e*g+2*Math.pow(g,3),j=Math.pow(i/2,2)+Math.pow(h/3,3);if(j>0){var k=Math.pow(-i/2+Math.sqrt(j),1/3);return[k-h/(3*k)-g]}if(0===j)return[3*i/h-g,-3*i/(2*h)-g,-3*i/(2*h)-g];if(0>j){var l=2*Math.sqrt(-h/3),m=-i/(2*Math.pow(-h/3,1.5)),n=Math.acos(m)/3;return[l*Math.cos(n)-g,l*Math.cos(n+2*Math.PI/3)-g,l*Math.cos(n+4*Math.PI/3)-g]}};return a}),angular.module("UnitsConversion").service("UnitsConversion",["Polynome",function(a){"use strict";var b=/(([\w-]+)\.)?(.*)/;this.data={temperature:{celcius:new a({a0:-273.15,a1:1}),fahrenheit:new a({a0:-459.67,a1:1.8}),kelvin:new a({a1:1})},color:{ebc:new a({a1:1}),srm:new a({a1:1/1.97}),lovibond:new a({a0:.561051,a1:.374734}),mcu:{direct:function(a){return a/1.97>=10?3.5*(a/1.97-50/7):10-Math.sqrt(100-5.0761421*a)},invert:function(a){return a>=10?3.94*(a+25)/7:(100-Math.pow(10-a,2))/5.0761421}},rgb:{direct:function(a){var b=function(a){var b="00"+a.toString(16);return b.substring(b.length-2)},c=Math.round(Math.min(255,Math.max(0,255*Math.pow(.975,a/1.97)))),d=Math.round(Math.min(255,Math.max(0,245*Math.pow(.88,a/1.97)))),e=Math.round(Math.min(255,Math.max(0,220*Math.pow(.7,a/1.97))));return"#"+b(c)+b(d)+b(e)},invert:function(a){return 0}}},sugar:{plato:new a({a3:135.997,a2:-630.272,a1:1111.14,a0:-616.868}),brix:new a({a3:182.4601,a2:-775.6821,a1:1262.7794,a0:-669.5622}),alcohol:new a({a1:1/.76,a0:-1/.76}),sg:new a({a1:1}),gPerLiter:new a({a3:1824.601,a2:-7756.821,a1:12627.794,a0:-6695.622})},mass:{kg:new a({a1:1}),g:new a({a1:1e3}),t:new a({a1:.001}),mg:new a({a1:1e6})},volume:{l:new a({a1:1}),ml:new a({a1:1e3}),dl:new a({a1:10}),cl:new a({a1:100}),dm3:new a({a1:1}),m3:new a({a1:.001}),cm3:new a({a1:1e3}),mm3:new a({a1:1e6}),"gal-us":new a({a1:.22}),"gal-en":new a({a1:.264}),pinte:new a({a1:1.76})}},this.fromTo=function(a,b,c,d){var e=function(a,b){this.origin=a,this.message=b},f=this.decodeType(b),g=this.decodeType(c),h=g.name,i=f.name;if(a="string"==typeof a?parseFloat(a):a,d=angular.extend({type:f.family,precision:null},d),!this.data[d.type])throw new e("from","Type "+d.type+" does not exist in the unit conversion system");if(!this.data[d.type][i])throw new e("from","Unit "+i+" does not exist for type "+d.type+"=> from = "+b);if(!this.data[d.type][h])throw new e("to","Unit "+h+" does not exist for type "+d.type+"=> to = "+c);var j=this.data[d.type][i].invert(a);if("number"!=typeof j)throw new e("from","Value "+a+" is out of bounce in unit "+i+", type "+d.type);var k=this.data[d.type][h].direct(j);if(d.precision&&"number"==typeof k){var l=Math.pow(10,d.precision);return Math.round(k*l)/l}return k},this.decodeType=function(a){if(!a)return{};var c=a.match(b);return c[3]?c[3]?{type:c[2]+"."+c[3],family:c[2],name:c[3]}:void 0:{family:c[2]}},this.getPhysicalUnits=function(a){var b=this,c=b.decodeType(a);if(!c.family)return Object.keys(this.data).map(function(a){return{type:a,units:Object.keys(b.data[a]).map(function(b){return{name:b,type:a+"."+b}})}});if(!c.name)return Object.keys(b.data[c.family]).map(function(a){return{name:a,type:c.family+"."+a}});if(c.name){var d;return Object.keys(this.data).forEach(function(a){Object.keys(b.data[a]).forEach(function(b){c.type===a+"."+b&&(d={name:b,type:a+"."+b})})}),d}},this.registerConversion=function(c,d,e){var f=d.match(b);if(f){f[3];e=e?e:f[2],this.prototype.data[e]=angular.extend({},this.prototype.data[e]),this.prototype.data[e][thisUnit]=new a(c)}}}]);